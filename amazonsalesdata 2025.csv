6-- Display only order_id, order_date, and total_sales.
select orderid ,date , totalsales from amazonsales2025;

use amazon_sales2025;

-- Find the total number of orders.
select count(*) as totalsales from amazonsales2025;

-- List all unique product categories.
select distinct category from amazonsales2025;

-- Find all orders where order_status = 'Delivered'.
select * from amazonsales2025 where status = 'delivered';

-- Show orders placed in the year 2025.
select * from amazonsales2025  where year(date) ='2025';

-- Count how many orders were placed in each region.
SELECT
    customerlocation,
    COUNT(DISTINCT orderid) AS totalsales
FROM amazonsales2025
GROUP BY customerlocation
ORDER BY totalsales DESC;

-- Find the minimum and maximum total_sales.
select min(totalsales) as  minimum_total_sales,
max(totalsales) as maximum_total_sales
from amazonsales2025;

-- Retrieve orders where total_sales is greater than 5,000.
select * from amazonsales2025 where totalsales > 5000;

-- Find the total quantity sold across all orders.
select sum(quantity) as total_quantity_sold from amazonsales2025;

-- Calculate total revenue generated by Amazon.
select sum(totalsales) as total_revenue from amazonsales2025;

-- Find total sales by each product category.
select category, 
sum(totalsales) as totalsales
 from amazonsales2025
 group by category;
 
 -- Identify the top 5 highest-selling products by revenue.
 SELECT
    product,
    SUM(totalsales) AS total_revenue
FROM amazonsales2025
GROUP BY product
ORDER BY total_revenue DESC
LIMIT 5;

-- Calculate average order value (AOV).
select avg(totalsales) as average_order_value from amazonsales2025;

-- Find monthly total sales.
SELECT
    YEAR(date) AS year,
    MONTH(date) AS month,
    SUM(totalsales) AS monthly_total_sales
FROM amazonsales2025
GROUP BY YEAR(date), MONTH(date)
ORDER BY year, month;

-- Show only the first 10 rows of the dataset.
select * from amazonsales2025 limit 10;

-- Find the total number of records in the table.
SELECT COUNT(*) AS total_records
FROM amazonsales2025;

-- Find the total sales amount for all orders.
select count(*) as total_sales from amazonsales2025;

-- Display all orders where the sales amount is greater than 10,000.
select * from amazonsales2025 where totalsales > 10000;

-- Count how many orders were placed for each product category.
SELECT
    category,
    COUNT(DISTINCT orderid) AS total_orders
FROM amazonsales2025
GROUP BY category
ORDER BY total_orders DESC;

-- List customers who have placed more than one order.
select customername,count(orderid) as total_orders from amazonsales2025 group by customername having count(orderid)>1;

-- Sort the orders by sales amount in descending order.
select * from amazonsales2025 order by totalsales DESC;

-- Find the total quantity sold for each product.
select product,
sum(quantity) as total_quantity_sold
from amazonsales2025
group by product;

-- Display all orders where the payment mode is online.
select * from amazonsales2025
where paymentmethod = 'online';

-- Find the top 5 products by total sales.
select product,
SUM(totalsales) as totalsales
from amazonsales2025
group by product
order by totalsales DESC
limit 5;

-- Display total sales and total quantity sold per category.
select category,
sum(totalsales) as totalsales,
sum(quantity) as totalquantitysold
from amazonsales2025
group by category
order by totalsales;

-- Find the average sales per order for each region.
select customerlocation,
avg(totalsales) as averagesalesperorder
from amazonsales2025
group by customerlocation
order by averagesalesperorder DESC;

-- List customers whose total purchase value is greater than the overall average sales.
select customername,
sum(totalsales) as total_purchase_value
from amazonsales2025
group by customername
having sum(totalsales) > (
select avg(totalsales)
from amazonsales2025
);

-- Find the month-wise total sales for the year 2025.
select  month(date) as month,
sum(totalsales) as totalsales
from amazonsales2025
where year(date) = 2025
group by month(date)
order by month;

-- Display categories where total sales exceed 1,00,000.
select category,
sum(totalsales) as totalsales
from amazonsales2025
group by category
having sum(totalsales) > 100000
order by totalsales DESC;

-- Identify the region with the highest number of orders.
select 
customerlocation,
count(orderid) as total_orders
from amazonsales2025
group by customerlocation
order by total_orders DESC
limit 1 ;

-- Find the second highest sales amount.
select MAX(totalsales) AS second_highest_sales
FROM amazonsales2025
WHERE totalsales < (
    select MAX(totalsales)
    FROM amazonsales2025);

-- Show orders where the sales amount is above the average sales.
select orderid,
    customername,
    totalsales
FROM amazonsales2025
WHERE totalsales > (
    select AVG(totalsales)
    FROM amazonsales2025);

-- Count how many distinct customers placed orders in each region.
select customerlocation,
    COUNT(DISTINCT customername) AS distinct_customers
FROM amazonsales2025
GROUP BY customerlocation
ORDER BY distinct_customers DESC;

-- Find customers who have never placed an order above 10,000.
select customername
FROM amazonsales2025
GROUP BY customername
HAVING MAX(totalsales) <= 10000;

-- Display each order along with a sales category:

High (> 20,000)

Medium (10,000–20,000)

Low (< 10,000)

-- Display each order along with a sales category:

High (> 20,000)

Medium (10,000–20,000)

Low (< 10,000)

-- Display each order along with a sales category:

High (> 20,000)

Medium (10,000–20,000)

Low (< 10,000)
select 
	orderid,
    customername,
    totalsales,
    CASE
        WHEN totalsales > 20000 THEN 'High'
        WHEN totalsales BETWEEN 10000 AND 20000 THEN 'Medium'
        ELSE 'Low'
    END AS category
FROM amazonsales2025;

-- Find the top-selling product in each category.
select
    category,
    product,
    totalsales
from (
    select
        category,
        product,
        SUM(totalsales) AS totalsales,
        DENSE_RANK() OVER (
            PARTITION BY category
            ORDER BY SUM(totalsales) DESC
        ) AS salesrank
    FROM amazonsales2025
    GROUP BY category, product
) t
WHERE salesrank = 1;

-- Show regions where average sales per order is greater than the overall average.
select
customerlocation,
avg(totalsales) as average_sales_per_order
from amazonsales2025
group by customerlocation
having avg (totalsales) >
( select 
avg(totalsales)
from amazonsales2025
);

-- Find products whose total sales are greater than the average product sales.
select 
    product,
    SUM(totalsales) AS totalproductsales
FROM amazonsales2025
GROUP BY product
HAVING SUM(totalsales) > (
    SELECT AVG(product)
    FROM (
        SELECT SUM(totalsales) AS product
        FROM amazonsales2025
        GROUP BY product
    ) t
);

-- Rank products by total sales.
select
    product,
    SUM(totalsales) AS total_product_sales,
    DENSE_RANK() OVER (
        ORDER BY SUM(totalsales) DESC
    ) AS sales
FROM amazonsales2025
GROUP BY product
ORDER BY sales;

-- Display the latest order for each customer.
select *
from (
    select *,
           ROW_NUMBER() OVER (
               PARTITION BY orderid
               ORDER BY date DESC
           ) AS rn
    FROM amazonsales2025
) t
WHERE rn = 1;

-- Find customers who have placed orders in more than one region.S
select orderid
from amazonsales2025
group by orderid
having count(distinct customerlocation) > 1;

-- Calculate the percentage contribution of each category to total sales.
select category,
sum(totalsales) as category_sales,
round (
sum(totalsales) * 100.0 / (select sum(totalsales) from amazonsales2025),
2 )
as per percentage_contribution 
from amazonsales2025
group by category
order by percentage_contribution DESC;

-- Identify orders whose sales amount is greater than the previous order (by date).
select *
from (
    select *,
           LAG(totalsales) OVER (ORDER BY date) AS previous_sales
    FROM amazonsales2025
) t
WHERE totalsales > previous_sales;





